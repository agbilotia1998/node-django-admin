extends layouts/default

block content
  - var action = base + '/' + path
  - action += doc.isNew ? '' : '/' + doc._id
  - var id = doc.isNew ? '' : doc._id
  
  h2= ( (id) ? "Edit " : "New " ) + ( (meta.name) ? meta.name : meta.model )

  #form
    form(method="post", action=action, enctype="multipart/form-data")
      input(type="hidden", name="_csrf", value="#{csrf_token}")
      input(type="hidden", name="_doc_id", value=id)
  
      table
        tbody
          each f in edit
            tr
              - var type = field[f].widget || 'text'
              - var header = field[f].header
              td
                label(for=f)= header
              td
                if type == 'sel' || type == 'ref'
                  - var sel = ((doc.isNew) ? doc[f] : doc[f][field[f].display] || doc[f])
                  select(id=f, name=path+'['+f+']', placeholder='Enter '+header)
                    each v in field[f].values
                      if v == sel
                        option(value=v, selected)= v
                      else
                        option(value=v)= v
                else
                  input(id=f, type=type, name=path+'['+f+']', value=doc[f], placeholder='Enter '+header)
        
      button(type='submit') Save changes
      &nbsp;
      a.btn(href='#{base}/#{path}', title="cancel") Cancel
